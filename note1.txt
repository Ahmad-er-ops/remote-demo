this is the modified version from conflict demo branch
